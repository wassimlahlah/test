<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"> <!--link icons-->
    <title>OverShop</title>
</head>

<body class="home">
    <!-- Header -->
     {% set current_page = request.endpoint %}
    <div class="container p-3">
        <div class="row justify-content-between">
            <div class="col-2">
                <h1 class="text-light" style="font-size: 3rem;font-weight: 750;">Over<span>Shop</span></h1>
            </div>
            <div class="col-3 pl-1 ">
                <nav class="navbar navbar-expand-lg navbar-light">
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#wassim">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="wassim">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                               <a href="{{ url_for('app.home') }}" class="nav-link {% if current_page == 'app.home' %}active{% endif %}">Home</a>
                             </li>
                             <li class="nav-item">
                               <a href="{{ url_for('app.shop') }}" class="nav-link {% if current_page == 'app.shop' %}active{% endif %}">Shop</a>
                             </li>
                             <li class="nav-item">
                               <a href="{{ url_for('app.news') }}" class="nav-link {% if current_page == 'app.news' %}active{% endif %}">News</a>
                             </li>
                             <!--user links-->
                   {% if current_user.is_authenticated and current_user.id == 1 %}
                     <!-- المالك بعد تسجيل الدخول -->
                     <div class="nav-item">
                       <a href="{{ url_for('app.dashbored') }}" class="nav-link {% if current_page == 'app.dashbored' %}active{% endif %}">Dashboard</a>
                     </div>
                     <div class="nav-item">
                       <a href="{{ url_for('app.logout') }}" class="nav-link {% if current_page == 'app.logout' %}active{% endif %}">Logout</a>
                     </div>
                   
                   {% elif not User.query.first() %}
                     <!-- أول مرة يدخل المالك (لا يوجد مستخدم بعد) -->
                     <li class="nav-item">
                       <a href="{{ url_for('app.register') }}" class="nav-link {% if current_page == 'app.register' %}active{% endif %}">Register</a>
                     </li>
                   
                   {% elif User.query.first() and not current_user.is_authenticated %}
                     <!-- المالك موجود لكن لم يسجل الدخول -->
                     <li class="nav-item">
                       <a href="{{ url_for('app.login') }}" class="nav-link {% if current_page == 'app.login' %}active{% endif %}">Login</a>
                     </li>
                   {% endif %}
                   

                        </ul>
                    </div>
                </nav>
            </div>
            
                <div class="col-2">
                <ul class="navbar nav">
                 <li class="nav-item">
                  <a href="{{url_for('app.order')}}" class="nav-link text-white">
                    <i class="fas fa-shopping-cart"></i> 
                  </a>
                 </li>
                </ul>
                </div>
                
           
        </div>
    </div>
         {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="container mt-2">
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show flash-message" role="alert">
            {{ message }}
            
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock content %}

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Flash Auto Close -->
  <script>
    setTimeout(function() {
      let alerts = document.querySelectorAll('.flash-message');
      alerts.forEach(function(alert) {
        $(alert).alert('close');
      });
    }, 3000); // 3 ثواني
  </script>
</body>
</html>